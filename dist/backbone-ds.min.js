!function(e){var n={},t={},r={};n.defineResource=function(e){var n;if(!e.collection)throw new Error("You must specify a collection when defining a resource");n=e.name,t[n]=e,r[n]||(r[n]=new e.collection)},n.createInstance=function(e){return new t[e].model},n.inject=function(e,n){r[e].add(n)},n.get=function(e,n){var o,i,c=t[e].idAttribute,u={};return i=r[e],i&&(u[c]=n,o=i.findWhere(u))?o:null},n.getAll=function(e){return r[e]},n.ejectAll=function(e){var n=r[e];n&&n.reset()},n.find=function(e,r){var o={},i=t[e].idAttribute,c=this.get("person",r),u=$.Deferred();return c?(u.resolve(c),u.promise()):(o[i]=r,c=new t[e].model(o),c.fetch().then(function(){return n.inject(e,c),c},function(){throw new Error("error fetching model: "+r)}))},n.removeResource=function(e){delete r[e]},e.DS=n}(window);