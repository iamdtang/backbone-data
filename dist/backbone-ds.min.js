!function(e){var n={},r={},t={};n.defineResource=function(e){var n;if(!e.collection)throw new Error("You must specify a collection when defining a resource");n=e.name,r[n]=e,t[n]||(t[n]=new e.collection)},n.createInstance=function(e){return new r[e].model},n.inject=function(e,n){var r=t[e];r.add(n)},n.get=function(e,n){var o,i,c=r[e].idAttribute,u={};return i=t[e],i&&(u[c]=n,o=i.findWhere(u))?o:null},n.getAll=function(e){return t[e]},n.ejectAll=function(e){var n=t[e];n&&n.reset()},n.find=function(e,t){var o={},i=r[e].idAttribute,c=this.get("person",t),u=$.Deferred();return c?(u.resolve(c),u.promise()):(o[i]=t,c=new r[e].model(o),c.fetch().then(function(){return n.inject(e,c),c},function(){throw new Error("error fetching model: "+t)}))},n.findAll=function(e){var r=t[e];return r.fetch().then(function(t){return n.inject(e,t),r},function(){throw new Error("error fetching collection: "+e)})},n.removeResource=function(e){delete t[e]},e.DS=n}(window);